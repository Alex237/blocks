import: ../patterns/grid.yaml

styles:
    filter-grid:
        mix: [patterns-grid]
        doc:
            author: 
                name: Patricio Gonzalez Vivo
                twitter: patriciogv
            version: 0.0.1
            tangram-version: 0.0.7
            licence: MIT
            description: |
                Apply a grid filter to the syle
                <p>The amount can be set by the GRID_AMOUNT define [0.0~1.0]</p>
                <p>Then you should choose a GRID_BLEND mode: ```ADD```, ```SUBSTRACT``` and ```MULTIPLY```</p>
        ui:
            GRID_AMOUNT: 
                type: number
                label: amount
                range: 
                    min: 0.
                    max: 1.
                    step: 0.01
            GRID_BLEND: 
                type: dropdown
                label: 'blend mode'
                values: ['ADD', 'SUBSTRACT', 'MULTIPLY']
        shaders:
            defines:
                ADD: '0'
                SUBSTRACT: '1'
                MULTIPLY: '2'
                
                GRID_AMOUNT: .2
                GRID_BLEND: 'ADD'
            blocks:                    
                filter: |
                    #if GRID_BLEND == ADD
                    color.rgb += tileGrid()*GRID_AMOUNT;
                    #endif
                    #if GRID_BLEND == SUBSTRACT
                    color.rgb -= tileGrid()*GRID_AMOUNT;
                    #endif
                    #if GRID_BLEND == MULTIPLY
                    color.rgb *= (1.-tileGrid()*GRID_AMOUNT);
                    #endif
